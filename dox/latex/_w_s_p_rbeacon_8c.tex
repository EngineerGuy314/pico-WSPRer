\doxysection{D\+:/\+Users/serych/\+SVN/\+Bastleni/\+HAB/pico-\/\+WSPRer/\+WSPRbeacon/\+WSPRbeacon.c File Reference}
\hypertarget{_w_s_p_rbeacon_8c}{}\label{_w_s_p_rbeacon_8c}\index{D:/Users/serych/SVN/Bastleni/HAB/pico-\/WSPRer/WSPRbeacon/WSPRbeacon.c@{D:/Users/serych/SVN/Bastleni/HAB/pico-\/WSPRer/WSPRbeacon/WSPRbeacon.c}}
{\ttfamily \#include "{}WSPRbeacon.\+h"{}}\newline
{\ttfamily \#include $<$WSPRutility.\+h$>$}\newline
{\ttfamily \#include $<$maidenhead.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{struct_w_s_p_rbeacon_context}{WSPRbeacon\+Context}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{_w_s_p_rbeacon_8c_ac3c9dc08cb6d8cb3eac8f4d35d68918b}{WSPRbeacon\+Init}} (const char \texorpdfstring{$\ast$}{*}pcallsign, const char \texorpdfstring{$\ast$}{*}pgridsquare, int txpow\+\_\+dbm, \mbox{\hyperlink{struct_pio_dco}{Pio\+Dco}} \texorpdfstring{$\ast$}{*}pdco, uint32\+\_\+t dial\+\_\+freq\+\_\+hz, uint32\+\_\+t shift\+\_\+freq\+\_\+hz, int gpio, uint8\+\_\+t start\+\_\+minute)
\begin{DoxyCompactList}\small\item\em Initializes a new WSPR beacon context. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{_w_s_p_rbeacon_8c_aa1689bc64306333d4793925c3bd99dc7}{WSPRbeacon\+Set\+Dial\+Freq}} (\mbox{\hyperlink{struct_w_s_p_rbeacon_context}{WSPRbeacon\+Context}} \texorpdfstring{$\ast$}{*}pctx, uint32\+\_\+t freq\+\_\+hz)
\begin{DoxyCompactList}\small\item\em Sets dial (baseband minima) freq. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{_w_s_p_rbeacon_8c_a627715ae59a40d64e2f12e35cee22e1f}{WSPRbeacon\+Create\+Packet}} (\mbox{\hyperlink{struct_w_s_p_rbeacon_context}{WSPRbeacon\+Context}} \texorpdfstring{$\ast$}{*}pctx, int packet\+\_\+type)
\begin{DoxyCompactList}\small\item\em Constructs a new WSPR packet using the data available. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{_w_s_p_rbeacon_8c_adde5f7a367372b48e684c89abeeb5835}{WSPRbeacon\+Send\+Packet}} (const \mbox{\hyperlink{struct_w_s_p_rbeacon_context}{WSPRbeacon\+Context}} \texorpdfstring{$\ast$}{*}pctx)
\begin{DoxyCompactList}\small\item\em Sends a prepared WSPR packet using Tx\+Channel. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{_w_s_p_rbeacon_8c_af1b1581f3666ea0fef0c3662bec93c52}{WSPRbeacon\+Tx\+Scheduler}} (\mbox{\hyperlink{struct_w_s_p_rbeacon_context}{WSPRbeacon\+Context}} \texorpdfstring{$\ast$}{*}pctx, int verbose)
\begin{DoxyCompactList}\small\item\em Arranges WSPR sending in accordance with pre-\/defined schedule. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{_w_s_p_rbeacon_8c_a6113600dd0ba7c6bc59b72763025f722}{WSPRbeacon\+Dump\+Context}} (const \mbox{\hyperlink{struct_w_s_p_rbeacon_context}{WSPRbeacon\+Context}} \texorpdfstring{$\ast$}{*}pctx)
\begin{DoxyCompactList}\small\item\em Dumps the beacon context to stdio. \end{DoxyCompactList}\item 
char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{_w_s_p_rbeacon_8c_adaf51700926db7846413fb61bbb0bcb0}{WSPRbeacon\+Get\+Last\+QTHLocator}} (const \mbox{\hyperlink{struct_w_s_p_rbeacon_context}{WSPRbeacon\+Context}} \texorpdfstring{$\ast$}{*}pctx)
\begin{DoxyCompactList}\small\item\em Extracts maidenhead type QTH locator (such as KO85) using GPS coords. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{_w_s_p_rbeacon_8c_aec8beb7a767e64378e0544cb81ee0c10}{WSPRbeacon\+Is\+GPSsolution\+Active}} (const \mbox{\hyperlink{struct_w_s_p_rbeacon_context}{WSPRbeacon\+Context}} \texorpdfstring{$\ast$}{*}pctx)
\item 
char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{_w_s_p_rbeacon_8c_abe800d0d795bd51c08dc4c4a89a97ee2}{add\+\_\+brackets}} (const char \texorpdfstring{$\ast$}{*}call)
\item 
char \mbox{\hyperlink{_w_s_p_rbeacon_8c_afd5fb08ec6b36c1cebaa0c38b4788791}{Encode\+Base36}} (uint8\+\_\+t val)
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{_w_s_p_rbeacon_8c_abe800d0d795bd51c08dc4c4a89a97ee2}\label{_w_s_p_rbeacon_8c_abe800d0d795bd51c08dc4c4a89a97ee2} 
\index{WSPRbeacon.c@{WSPRbeacon.c}!add\_brackets@{add\_brackets}}
\index{add\_brackets@{add\_brackets}!WSPRbeacon.c@{WSPRbeacon.c}}
\doxysubsubsection{\texorpdfstring{add\_brackets()}{add\_brackets()}}
{\footnotesize\ttfamily char \texorpdfstring{$\ast$}{*} add\+\_\+brackets (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{call }\end{DoxyParamCaption})}

\Hypertarget{_w_s_p_rbeacon_8c_afd5fb08ec6b36c1cebaa0c38b4788791}\label{_w_s_p_rbeacon_8c_afd5fb08ec6b36c1cebaa0c38b4788791} 
\index{WSPRbeacon.c@{WSPRbeacon.c}!EncodeBase36@{EncodeBase36}}
\index{EncodeBase36@{EncodeBase36}!WSPRbeacon.c@{WSPRbeacon.c}}
\doxysubsubsection{\texorpdfstring{EncodeBase36()}{EncodeBase36()}}
{\footnotesize\ttfamily char Encode\+Base36 (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{val }\end{DoxyParamCaption})}

\Hypertarget{_w_s_p_rbeacon_8c_a627715ae59a40d64e2f12e35cee22e1f}\label{_w_s_p_rbeacon_8c_a627715ae59a40d64e2f12e35cee22e1f} 
\index{WSPRbeacon.c@{WSPRbeacon.c}!WSPRbeaconCreatePacket@{WSPRbeaconCreatePacket}}
\index{WSPRbeaconCreatePacket@{WSPRbeaconCreatePacket}!WSPRbeacon.c@{WSPRbeacon.c}}
\doxysubsubsection{\texorpdfstring{WSPRbeaconCreatePacket()}{WSPRbeaconCreatePacket()}}
{\footnotesize\ttfamily int WSPRbeacon\+Create\+Packet (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_w_s_p_rbeacon_context}{WSPRbeacon\+Context}} \texorpdfstring{$\ast$}{*}}]{pctx,  }\item[{int}]{packet\+\_\+type }\end{DoxyParamCaption})}



Constructs a new WSPR packet using the data available. 


\begin{DoxyParams}{Parameters}
{\em pctx} & Context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if OK. 
\end{DoxyReturn}
\Hypertarget{_w_s_p_rbeacon_8c_a6113600dd0ba7c6bc59b72763025f722}\label{_w_s_p_rbeacon_8c_a6113600dd0ba7c6bc59b72763025f722} 
\index{WSPRbeacon.c@{WSPRbeacon.c}!WSPRbeaconDumpContext@{WSPRbeaconDumpContext}}
\index{WSPRbeaconDumpContext@{WSPRbeaconDumpContext}!WSPRbeacon.c@{WSPRbeacon.c}}
\doxysubsubsection{\texorpdfstring{WSPRbeaconDumpContext()}{WSPRbeaconDumpContext()}}
{\footnotesize\ttfamily void WSPRbeacon\+Dump\+Context (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_w_s_p_rbeacon_context}{WSPRbeacon\+Context}} \texorpdfstring{$\ast$}{*}}]{pctx }\end{DoxyParamCaption})}



Dumps the beacon context to stdio. 


\begin{DoxyParams}{Parameters}
{\em pctx} & Ptr to Context. \\
\hline
\end{DoxyParams}
\Hypertarget{_w_s_p_rbeacon_8c_adaf51700926db7846413fb61bbb0bcb0}\label{_w_s_p_rbeacon_8c_adaf51700926db7846413fb61bbb0bcb0} 
\index{WSPRbeacon.c@{WSPRbeacon.c}!WSPRbeaconGetLastQTHLocator@{WSPRbeaconGetLastQTHLocator}}
\index{WSPRbeaconGetLastQTHLocator@{WSPRbeaconGetLastQTHLocator}!WSPRbeacon.c@{WSPRbeacon.c}}
\doxysubsubsection{\texorpdfstring{WSPRbeaconGetLastQTHLocator()}{WSPRbeaconGetLastQTHLocator()}}
{\footnotesize\ttfamily char \texorpdfstring{$\ast$}{*} WSPRbeacon\+Get\+Last\+QTHLocator (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_w_s_p_rbeacon_context}{WSPRbeacon\+Context}} \texorpdfstring{$\ast$}{*}}]{pctx }\end{DoxyParamCaption})}



Extracts maidenhead type QTH locator (such as KO85) using GPS coords. 


\begin{DoxyParams}{Parameters}
{\em pctx} & Ptr to WSPR beacon context. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
ptr to string of QTH locator (static duration object inside get\+\_\+mh). 
\end{DoxyReturn}
\begin{DoxyRemark}{Remarks}
It uses third-\/party project \href{https://github.com/sp6q/maidenhead}{\texttt{ https\+://github.\+com/sp6q/maidenhead}} . 
\end{DoxyRemark}
\Hypertarget{_w_s_p_rbeacon_8c_ac3c9dc08cb6d8cb3eac8f4d35d68918b}\label{_w_s_p_rbeacon_8c_ac3c9dc08cb6d8cb3eac8f4d35d68918b} 
\index{WSPRbeacon.c@{WSPRbeacon.c}!WSPRbeaconInit@{WSPRbeaconInit}}
\index{WSPRbeaconInit@{WSPRbeaconInit}!WSPRbeacon.c@{WSPRbeacon.c}}
\doxysubsubsection{\texorpdfstring{WSPRbeaconInit()}{WSPRbeaconInit()}}
{\footnotesize\ttfamily \mbox{\hyperlink{struct_w_s_p_rbeacon_context}{WSPRbeacon\+Context}} \texorpdfstring{$\ast$}{*} WSPRbeacon\+Init (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{pcallsign,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{pgridsquare,  }\item[{int}]{txpow\+\_\+dbm,  }\item[{\mbox{\hyperlink{struct_pio_dco}{Pio\+Dco}} \texorpdfstring{$\ast$}{*}}]{pdco,  }\item[{uint32\+\_\+t}]{dial\+\_\+freq\+\_\+hz,  }\item[{uint32\+\_\+t}]{shift\+\_\+freq\+\_\+hz,  }\item[{int}]{gpio,  }\item[{uint8\+\_\+t}]{start\+\_\+minute }\end{DoxyParamCaption})}



Initializes a new WSPR beacon context. 


\begin{DoxyParams}{Parameters}
{\em pcallsign} & HAM radio callsign, 12 chr max. \\
\hline
{\em pgridsquare} & Maidenhead locator, 7 chr max. \\
\hline
{\em txpow\+\_\+dbm} & TX power, db\`{}mW. \\
\hline
{\em pdco} & Ptr to working DCO. \\
\hline
{\em dial\+\_\+freq\+\_\+hz} & The begin of working WSPR passband. \\
\hline
{\em shift\+\_\+freq\+\_\+hz} & The shift of tx freq. relative to dial\+\_\+freq\+\_\+hz. \\
\hline
{\em gpio} & Pico\textquotesingle{}s GPIO pin of RF output. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Ptr to the new context. 
\end{DoxyReturn}
\Hypertarget{_w_s_p_rbeacon_8c_aec8beb7a767e64378e0544cb81ee0c10}\label{_w_s_p_rbeacon_8c_aec8beb7a767e64378e0544cb81ee0c10} 
\index{WSPRbeacon.c@{WSPRbeacon.c}!WSPRbeaconIsGPSsolutionActive@{WSPRbeaconIsGPSsolutionActive}}
\index{WSPRbeaconIsGPSsolutionActive@{WSPRbeaconIsGPSsolutionActive}!WSPRbeacon.c@{WSPRbeacon.c}}
\doxysubsubsection{\texorpdfstring{WSPRbeaconIsGPSsolutionActive()}{WSPRbeaconIsGPSsolutionActive()}}
{\footnotesize\ttfamily uint8\+\_\+t WSPRbeacon\+Is\+GPSsolution\+Active (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_w_s_p_rbeacon_context}{WSPRbeacon\+Context}} \texorpdfstring{$\ast$}{*}}]{pctx }\end{DoxyParamCaption})}

\Hypertarget{_w_s_p_rbeacon_8c_adde5f7a367372b48e684c89abeeb5835}\label{_w_s_p_rbeacon_8c_adde5f7a367372b48e684c89abeeb5835} 
\index{WSPRbeacon.c@{WSPRbeacon.c}!WSPRbeaconSendPacket@{WSPRbeaconSendPacket}}
\index{WSPRbeaconSendPacket@{WSPRbeaconSendPacket}!WSPRbeacon.c@{WSPRbeacon.c}}
\doxysubsubsection{\texorpdfstring{WSPRbeaconSendPacket()}{WSPRbeaconSendPacket()}}
{\footnotesize\ttfamily int WSPRbeacon\+Send\+Packet (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_w_s_p_rbeacon_context}{WSPRbeacon\+Context}} \texorpdfstring{$\ast$}{*}}]{pctx }\end{DoxyParamCaption})}



Sends a prepared WSPR packet using Tx\+Channel. 


\begin{DoxyParams}{Parameters}
{\em pctx} & Context. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0, if OK. 
\end{DoxyReturn}
\Hypertarget{_w_s_p_rbeacon_8c_aa1689bc64306333d4793925c3bd99dc7}\label{_w_s_p_rbeacon_8c_aa1689bc64306333d4793925c3bd99dc7} 
\index{WSPRbeacon.c@{WSPRbeacon.c}!WSPRbeaconSetDialFreq@{WSPRbeaconSetDialFreq}}
\index{WSPRbeaconSetDialFreq@{WSPRbeaconSetDialFreq}!WSPRbeacon.c@{WSPRbeacon.c}}
\doxysubsubsection{\texorpdfstring{WSPRbeaconSetDialFreq()}{WSPRbeaconSetDialFreq()}}
{\footnotesize\ttfamily void WSPRbeacon\+Set\+Dial\+Freq (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_w_s_p_rbeacon_context}{WSPRbeacon\+Context}} \texorpdfstring{$\ast$}{*}}]{pctx,  }\item[{uint32\+\_\+t}]{freq\+\_\+hz }\end{DoxyParamCaption})}



Sets dial (baseband minima) freq. 


\begin{DoxyParams}{Parameters}
{\em pctx} & Context. \\
\hline
{\em freq\+\_\+hz} & the freq., Hz. \\
\hline
\end{DoxyParams}
\Hypertarget{_w_s_p_rbeacon_8c_af1b1581f3666ea0fef0c3662bec93c52}\label{_w_s_p_rbeacon_8c_af1b1581f3666ea0fef0c3662bec93c52} 
\index{WSPRbeacon.c@{WSPRbeacon.c}!WSPRbeaconTxScheduler@{WSPRbeaconTxScheduler}}
\index{WSPRbeaconTxScheduler@{WSPRbeaconTxScheduler}!WSPRbeacon.c@{WSPRbeacon.c}}
\doxysubsubsection{\texorpdfstring{WSPRbeaconTxScheduler()}{WSPRbeaconTxScheduler()}}
{\footnotesize\ttfamily int WSPRbeacon\+Tx\+Scheduler (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_w_s_p_rbeacon_context}{WSPRbeacon\+Context}} \texorpdfstring{$\ast$}{*}}]{pctx,  }\item[{int}]{verbose }\end{DoxyParamCaption})}



Arranges WSPR sending in accordance with pre-\/defined schedule. 

It works only if GPS receiver available (for now). 
\begin{DoxyParams}{Parameters}
{\em pctx} & Ptr to Context. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if OK, -\/1 if NO GPS received available 
\end{DoxyReturn}
